#!/usr/bin/env python3

import argparse
import sys
import logging
from feature_extractors.api import extract


parser = argparse.ArgumentParser()
parser.add_argument("extractor")
parser.add_argument("action", nargs="?")
parser.add_argument("input", nargs="?")
parser.add_argument("output", nargs="?")
parser.add_argument("--gpus", default=None, help="Specify which gpus to use e.g. 1,2,3")
parser.add_argument("--cpus", default=None, help="Specify which cpus to use e.g. 1,2,3")
parser.add_argument("--verbose", action="store_true")

args, rest_args = parser.parse_known_args()

if args.verbose:
    logging.basicConfig(level=logging.DEBUG)
else:
    logging.basicConfig(level=logging.INFO, format="%(message)s")


extract(
    extractor=args.extractor,
    action=args.action,
    input_=args.input,
    output=args.output,
    rest_args=" ".join(rest_args),
    gpus=args.gpus,
    cpus=args.cpus,
)
